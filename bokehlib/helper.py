import numpy as np

def count_multi_points(row,kc,df):
    row['count'] = np.NaN
    if row.name > 3:
        if (row['Latitude'],row['Longitude']) not in kc:
            kc.append((row['Latitude'],row['Longitude']))
            multi_point_df = df[(df['Longitude'] == row['Longitude']) & (df['Latitude'] == row['Latitude'])]
            row['count'] = multi_point_df.shape[0]     
        
    return row['count']
    
    
def count_multi_points_ip(row,kc,df):
    row['count'] = np.NaN
    if row.name > 3:
        if (row['Latitude'],row['Longitude']) not in kc:
            kc.append((row['Latitude'],row['Longitude']))
            multi_point_df = df[(df['Longitude'] == row['Longitude']) & (df['Latitude'] == row['Latitude'])]
            row['count'] = multi_point_df.shape[0]     

            row['ip'] = ", ".join(list(multi_point_df['ip4_1'].unique()))
            row['domain'] = ", ".join(list(multi_point_df['domain'].unique()))
            
    return row
        