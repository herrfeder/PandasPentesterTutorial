\documentclass[convert={density=300,size=1080x1000,outext=.png}]{standalone}
\usepackage[utf8]{inputenc}
\usepackage{tikz}
\usepackage{enumitem}
\usepackage{graphicx}
\usetikzlibrary{arrows,shadows,decorations,backgrounds,fit,positioning,shapes,chains}
\usepackage{epstopdf}


\usepackage{pgf-umlsd}

\tikzset{font=\tiny}

\begin{document}

\centering
\begin{sequencediagram}
\renewcommand\unitfactor{0.6}
\tikzstyle{inststyle}+=[bottom color=green, rounded corners=1.0ex]
	\newthread[white]{b}{Browser}
	\newinst[2]{f}{Flask (Gunicorn)}
	\newinst[1]{t}{ThreadManager (Singleton)}
	\newinst[1]{p}{prepareData (Thread)}
	\newinst[1]{i}{ESInterfaceUpload (Thread)}
	\newinst[1]{e}{Elasticsearch (Docker-Container)}
 
\begin{call}{b}{Click Upload}{f}{Get Feedback via Message}
\end{call}
\begin{call}{f}{Upload() inits Thread Manager}{t}{}  
\end{call}
\begin{call}{t}{Init prepareData}{p}{Return ThreadFinished}
	\begin{sdblock}[green!20]{Run until Directory empty}{}
	%Read, Split, Process of Credential Data
		\begin{call}{p}{Init ESInterfaceUpload}{i}{}
		\end{call}
		\begin{call}{p}{Push 1000 Sets of Credentials}{i}{}
			\begin{call}{i}{Bulk Push}{e}{Unreadable}
			\end{call}
		\end{call}
	\end{sdblock}
\end{call}
\end{sequencediagram}

\end{document}
